<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Norbert Pape</title>
    <meta name="viewport" content="width =device-width, initial-scale=1.0">
    <meta name="description" content="Personal website of Norbert Pape">
    <meta name="keywords" content="Norbert Pape, dance, art, choreography, VR, performance, augmented reality, contemporary art, virtual reality, unity, quest, oculus, pedagogy, self-organisation" />
</head>
<body>


    <script async src="https://unpkg.com/es-module-shims@1.8.0/dist/es-module-shims.js"></script>

    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three@0.156.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.156.1/examples/jsm/"
          }
        }
    </script>

    <script type="module">

        import * as THREE from 'https://unpkg.com/three/build/three.module.js'
        import Stats from 'https://unpkg.com/three/examples/jsm/libs/stats.module.js'
        import { OrbitControls } from 'https://unpkg.com/three/examples/jsm/controls/OrbitControls.js';
        import { GLTFLoader } from 'https://unpkg.com/three/examples/jsm/loaders/GLTFLoader.js';
        import { GUI } from 'https://unpkg.com/three/examples/jsm/libs/lil-gui.module.min.js';
        import { DecalGeometry } from 'https://unpkg.com/three/examples/jsm/geometries/DecalGeometry.js';

        const container = document.getElementById('container');

        let renderer, scene, camera, stats;
        let mesh;
        let raycaster;

        const intersection = {
            intersects: false,
            point: new THREE.Vector3(),
            normal: new THREE.Vector3()
        };
        const mouse = new THREE.Vector2();
        const intersects = [];

        const textureLoader = new THREE.TextureLoader();

        let mouseHelper;
        const position = new THREE.Vector3();
        const orientation = new THREE.Euler();
        const size = new THREE.Vector3(10, 10, 10);

        init();
        animate();

        function init() {

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);
            //container.appendChild(renderer.domElement);

            stats = new Stats();
            document.body.appendChild(stats.dom);
            //container.appendChild(stats.dom);

            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0);

            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.z = 30;

            const controls = new OrbitControls(camera, renderer.domElement);
            controls.minDistance = 10;
            controls.maxDistance = 30;

            scene.add(new THREE.AmbientLight(0x666666));

            const light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(0, 20, 0); //default; light shining from top
            light.castShadow = true; // default false
            scene.add(light);

            //Create a plane that receives shadows (but does not cast them)
            const planeGeometry = new THREE.PlaneGeometry(200, 200, 32, 32);
            planeGeometry.rotateX(- Math.PI / 2);
            const planeMaterial = new THREE.MeshStandardMaterial({ color: 0xaaaaaa })
            const plane = new THREE.Mesh(planeGeometry, planeMaterial);
            plane.position.y = -7;
            plane.receiveShadow = true;
            scene.add(plane);

            ////Create a helper for the shadow camera (optional)
            //const helper = new THREE.CameraHelper(light.shadow.camera);
            //scene.add(helper);



            loadLeePerrySmith();


            mouseHelper = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 10), new THREE.MeshNormalMaterial());
            mouseHelper.visible = false;
            scene.add(mouseHelper);

            window.addEventListener('resize', onWindowResize);

            let moved = false;

            controls.addEventListener('change', function () {

                moved = true;

            });

            window.addEventListener('pointerdown', function () {

                moved = false;

            });



        }

        function loadLeePerrySmith() {

            const loader = new GLTFLoader();

            loader.load('3D/models/Canoe.glb', function (gltf) {

                mesh = gltf.scene.children[0];
                mesh.rotateX(- Math.PI);
                mesh.material = new THREE.MeshStandardMaterial({ color: 0x7F550D });
                mesh.scale.set(0.03, 0.03, 0.03);
                mesh.castShadow = true;
                scene.add(mesh);


            });

        }


        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(window.innerWidth, window.innerHeight);

        }

        function animate() {

            requestAnimationFrame(animate);

            renderer.render(scene, camera);

            stats.update();

        }

    </script>

</body>
</html>
